{"componentChunkName":"component---src-templates-blog-post-js","path":"/how-to-smartly-cleanup-your-commit-history-using-git/","result":{"data":{"site":{"siteMetadata":{"title":"Aman's Blog","author":"Amandeep Singh"}},"markdownRemark":{"id":"424f6cab-e33a-55e0-9303-3e94d05a63cc","excerpt":"TLDR Running  will move the branch to this old commit. And now when you run , you will see all the changes you have made since  in your staging area. You can‚Ä¶","html":"<h3>TLDR</h3>\n<p>Running <code class=\"language-text\">git reset --soft &lt;commit-hash&gt;</code> will move the branch to this old commit. And now when you run <code class=\"language-text\">git status</code>, you will see all the changes you have made since <code class=\"language-text\">commit-hash</code> in your staging area. You can then create a single commit to update your commit history. </p>\n<p>With <code class=\"language-text\">--mixed</code>(also a default) flag, Git will match your staging area with the content snapshot at that commit, which means all those changes since old commit have been unstaged too. Now, you can selectively stage those files and can create multiple new commits however you want.</p>\n<hr>\n<p>A commit message should justify your intent for the change, and not just add unnecessary noise to the Git history. Therefore, It‚Äôs a good habit to keep your commit history clean and Git has a few tools to achieve this.</p>\n<p>In this article, I will show you how you can smartly clean up your commit history using <code class=\"language-text\">git reset</code> But before I throw in that tip, I would also like to unveil the reasoning behind it so that it can be more fruitful in a long run.</p>\n<p>If you wish to skip the basics, you can jump straight to the <a href=\"#cleanup\">cleanup section</a> too. </p>\n<p>Let‚Äôs get started. </p>\n<h3>Pointers üëà</h3>\n<p><strong>HEAD</strong> and <strong>branch</strong> are two different concepts in Git. The branch is just a lightweight movable pointer to one of the commits you are on, whereas, HEAD by default points to the branch you are currently on.</p>\n<p><img src=\"Pointer.png\" alt=\"Pointers\"></p>\n<p>When Git moves the HEAD, it also modifies the index and working directory to reflect the changes of that commit.</p>\n<p>Now when you run <code class=\"language-text\">git reset</code>, it moves the branch HEAD is pointing to. For example, if you are on <code class=\"language-text\">master</code> branch, running <code class=\"language-text\">git reset 8fgh5</code> will move the branch to this commit as shown in the picture below:\n<img src=\"git%20reset.png\" alt=\"git reset\"></p>\n<blockquote>\n<p><code class=\"language-text\">git reset</code> moves the branch HEAD is pointing to.\n<code class=\"language-text\">git checkout &lt;branch-name&gt;</code> moves the HEAD to that branch.</p>\n</blockquote>\n<p>Git reset has 3 flavours at your disposal: ‚Äî<em>soft</em>, ‚Äî<em>mixed</em>, and ‚Äî<em>hard</em>. Irrespective of which one you chose, running <code class=\"language-text\">git reset</code> will always start by moving the branch HEAD points to, and stops where you ask it to. It runs the following operations in order: </p>\n<ol>\n<li>Move the branch HEAD point to (<strong>stop here if ‚Äîsoft</strong>).</li>\n<li>Modify the index(staging area) to look like HEAD (<strong>stop here if ‚Äîmixed</strong>).</li>\n<li>Make the working directory looks like the index (<strong>‚Äîhard</strong>).</li>\n</ol>\n<p>With the foundation set aside, let‚Äôs see how can you use the <code class=\"language-text\">--soft</code> and <code class=\"language-text\">--mixed</code>(also a default) options with <code class=\"language-text\">git reset</code> to clean up your commit history.</p>\n<p>Time for some awesomeness üéâ.</p>\n<h3><span id=\"cleanup\">It‚Äôs cleanup time</span> ‚è∞</h3>\n<p>If you have been lazily writing multiple vague commits, you can use <code class=\"language-text\">git reset --soft &lt;old-commit&gt;</code> to make your branch point to that old commit. And as we learned, Git will start by moving the branch pointer to it and stops right there. <strong>It won‚Äôt modify the index or working directory</strong>. And everything you have committed so far since this commit (old-commit) will be shown in your staging area. It essentially undid all the <code class=\"language-text\">git commit</code> commands. Running <code class=\"language-text\">git status</code> will now show ‚ÄòChanges to be committed‚Äô message.     </p>\n<p>Now, you can go ahead and commit those changes with a new message üòç. </p>\n<p>I normally use <code class=\"language-text\">--soft</code> reset variant when I feel like squashing old commits into a single commit. But if you wish to create multiple commits starting from <code class=\"language-text\">old-commit</code>, you can also run <code class=\"language-text\">git reset &lt;old-commit&gt;</code>. Git runs this command with <code class=\"language-text\">--mixed</code> option by default. Doing so, Git will move your branch to that commit but also <strong>modifies your index area to match HEAD</strong>. In other words, all the changes you have committed since then will be unstaged. Think of it as the opposite of <code class=\"language-text\">git add</code>. Running <code class=\"language-text\">git status</code> will now show <code class=\"language-text\">Changes not staged for commit</code> message. </p>\n<p>Now you can selectively add files to the staging area and create meaningful commits to clean up your commit history.</p>\n<blockquote>\n<p><strong>HEAD~{n}</strong> refers to the nth parent of your HEAD. So, <strong>HEAD~1</strong> gives you the first parent commit of HEAD. </p>\n</blockquote>\n<h3>Closing thoughts üëã</h3>\n<p>I‚Äôve always enjoyed this proverb: </p>\n<blockquote>\n<p>‚ÄúGive a man a fish and you feed him for a day; teach a man to fish and you feed him for a lifetime.‚Äù</p>\n</blockquote>\n<p>I hope that through this article I have not just given you a tip, but also have elaborated the rationale behind it. Now you can feel more confident using <code class=\"language-text\">git reset</code> in your daily workflow. Strive to keep your commit history clean, and your future colleagues will thank you for this üôè. </p>\n<hr>\n<p>That‚Äôs for today. And if you are interested in learning another tip, here‚Äôs my article about <a href=\"https://www.amanexplains.com/git-interactive-enhance-your-work-productiviy-by-10X/\">git interactive</a>.</p>","frontmatter":{"title":"How to smartly cleanup your commit history using git reset?","date":"August 17, 2020","description":"Strive to keep your commit history clean, and your future colleagues will thank you for this. Let's see how can you do it using git reset."}}},"pageContext":{"slug":"/how-to-smartly-cleanup-your-commit-history-using-git/","previous":{"fields":{"slug":"/git-interactive-enhance-your-work-productiviy-by-10X/"},"frontmatter":{"title":"Git Interactive‚Äîenhance your work productivity by 10X"}},"next":{"fields":{"slug":"/an-easy-explanation-to-prototypal-delegation-in-javascript/"},"frontmatter":{"title":"An Easy Explanation to Prototypal Delegation in JavaScript"}}}},"staticQueryHashes":["426816048","63159454"]}