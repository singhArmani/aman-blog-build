{"data":{"site":{"siteMetadata":{"title":"Aman's Blog","author":"Amandeep Singh"}},"markdownRemark":{"id":"e6eb8374-ad00-5aca-b82f-7a7cad1f7aa2","excerpt":"The year 2018 brought a lot of new features into the React Ecosystem. The addition of these features is helping developers to focus more on user experience‚Ä¶","html":"<p>The year 2018 brought a lot of new features into the React Ecosystem. The addition of these features is helping developers to focus more on user experience rather than spending time writing code logic.</p>\n<p>It seems that React is investing more towards a functional programming paradigm, in a search of great tools for building a UI which is more robust and scalable.</p>\n<p>Recently, at <a href=\"https://conf.reactjs.org/\">ReactConf</a> October 2018, React announced a proposal API called Hooks which took the community by storm. Since then developers are exploring and doing experiments with them and it has received a great feedback in the <a href=\"https://github.com/reactjs/rfcs/pull/68\">RFC</a> (Requests for comments).</p>\n<p>This article is my attempt to explain:</p>\n<ul>\n<li>\n<p>Why hooks were introduced</p>\n</li>\n<li>\n<p>How can we prepare ourselves for this API</p>\n</li>\n<li>\n<p>How can we write 90% cleaner code by using React Hooks üé£</p>\n</li>\n</ul>\n<p>If you just want to have a feel of this new API first, I have created a <a href=\"https://codesandbox.io/s/6ymrnqn43w\">demo</a> to play with. Otherwise, let‚Äôs get started by looking at 3 major problems we are facing as of now:</p>\n<h3>1. Reusing Code Logic</h3>\n<p>You all know that reusing code logic is hard and it requires a fair bit of experience to get your head around. When I started learning React about two years ago, I used to create class components to encapsulate all my logic. And when it comes to sharing the logic across different components I would simply create a similar looking component which would render a different UI. But that was not good. I was violating the <a href=\"https://en.wikipedia.org/wiki/Don%27t_repeat_yourself\">DRY</a> principle and ideally was not reusing the logic.</p>\n<h5>The Old Way</h5>\n<p>Slowly, I learned about <a href=\"https://reactjs.org/docs/higher-order-components.html\">HOC</a> pattern which allowed me to use functional programming for reusing my code logic. HOC is nothing but a simple <a href=\"https://en.wikipedia.org/wiki/Higher-order_function\">higher order function</a> which takes another component(dumb) and returns a new enhanced component. This enhanced component will encapsulate your logic.</p>\n<blockquote>\n<p>A higher order function is a function that takes a function as an argument, or returns a function.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token constant\">HOC</span><span class=\"token punctuation\">(</span>WrappedComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">EnhancedComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token comment\">/*\n     Encapsulate your logic here...\n   */</span>\n\n    <span class=\"token comment\">// render the UI using Wrapped Component</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>WrappedComponent</span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">this</span><span class=\"token punctuation\">.</span><span class=\"token attr-value\">props</span><span class=\"token punctuation\">}</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">this</span><span class=\"token punctuation\">.</span><span class=\"token attr-value\">state</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// You have to statically create your</span>\n  <span class=\"token comment\">// new Enchanced component before using it</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> EnhancedComponent <span class=\"token operator\">=</span> <span class=\"token constant\">HOC</span><span class=\"token punctuation\">(</span>someDumbComponent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token comment\">// And then use it as Normal component</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>EnhancedComponent</span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<br/>\n<p>Then we moved into the trend of passing function as props which marks the rise of the <a href=\"https://reactjs.org/docs/render-props.html\">render props</a> pattern. Render prop is a powerful pattern where <em>‚Äúrendering controller‚Äù</em> is in your hands. This facilitates the <a href=\"https://en.wikipedia.org/wiki/Inversion_of_control\">inversion of control(IoC)</a> design principle. The React documentation describes it as a technique for sharing code between components using a <strong>prop</strong> whose value is a <strong>function</strong>.</p>\n<blockquote>\n<p>A component with a render prop takes a function that returns a\n<a href=\"https://reactjs.org/blog/2015/12/18/react-components-elements-and-instances.html#elements-describe-the-tree\">React element</a> and calls it instead of implementing its own render logic.</p>\n</blockquote>\n<p>In simple words, you create a <strong>class</strong> component to encapsulate your logic (side effects) and when it comes to render, this component simply calls your function by passing only the data which is required to render the UI.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RenderProps</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n<span class=\"token comment\">/*\n  Encapsulate your logic here...\n*/</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// call the functional props by passing the data required to render UI</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n <span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Use it to draw whatever UI you want. Control is in your hand (IoC)</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>RenderProps</span> <span class=\"token attr-name\">render</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>data <span class=\"token operator\">=></span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>SomeUI</span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">data</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span> <span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<br/>\n<p>Even though both of these patterns were resolving the reusing code logic issues, they left us with a wrapper hell problem as shown below:</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d1716b3c14f48bdda413697e9487da00/ae30e/wrapper-hell-problem.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 61%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABn0lEQVQoz4VSSW7cMBDU/x/hR+QQIMgDDJ9zz8VBZjwaSEOKa3MpFylZIy9IKLa6KZKlqu4ejNLWayPiQ4whCt8ikjgzZ5Vc/mO5SAGk0hLjoQWiFeL5DHeboNUFzip4r5EkIKWIHMMWB8ax+76ODryP6ekRzz++o42BFttHN8/V3+YaxNRcUi2ldOuj+R6XPvd1yZXs6u/Hn/XXt4eacqoDt6Uhl5xrmCbIZQSBYfVMphohGOQsoJrVclzX9KVk3itw3sEuVJSkM+yAHJWZgzud4EfKJqiZXmDtDLJGFLvZGoe49HSkLQVU1f2AjWFT1nwDDdcrZByRrUNP0rr177Ed2SXXOybEOXgyTUohG4Mi8jUGz3+0d5I74AYarYX/e0Iwmv0QIaxoiLrnr+eO9kagHhTsgG/0jqDBeyyXFxg1YnEjk39jjzn+wCHlsMmsXwMeMHfQ9gTK9vMEY9bisFf6Plvqfq7eQd8BHunvno8jqB7PmG9/MKtnqOUE5xTKh2J9yuEx0UfQdtFqDUOmi7rCkm2SyD5LvWDN2Oj97CtBMaz0hPUXjgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"alt text\"\n        title=\"wrapper hell\"\n        src=\"/static/d1716b3c14f48bdda413697e9487da00/623ee/wrapper-hell-problem.png\"\n        srcset=\"/static/d1716b3c14f48bdda413697e9487da00/816c5/wrapper-hell-problem.png 148w,\n/static/d1716b3c14f48bdda413697e9487da00/c766b/wrapper-hell-problem.png 295w,\n/static/d1716b3c14f48bdda413697e9487da00/623ee/wrapper-hell-problem.png 590w,\n/static/d1716b3c14f48bdda413697e9487da00/ae30e/wrapper-hell-problem.png 800w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>So, to sum it up we can see there are few problems associated with reusing code logic:</p>\n<ul>\n<li>Not very intuitive to implement</li>\n<li>Lots of code</li>\n<li>Wrapper hell</li>\n</ul>\n<h3>2. Giant Components</h3>\n<p>Components are the basic unit of code reuse in React. When we have to abstract more than one behaviour into our class component, it tends to grow in size and becomes hard to maintain.</p>\n<blockquote>\n<p>A class should have one and only one reason to change,\nmeaning that a class should have only one job.</p>\n</blockquote>\n<p>By looking at the code example below we can deduce the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">GiantComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//side effects</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">makeRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    document<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'...'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timerId <span class=\"token operator\">=</span> <span class=\"token function\">startTimer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>    <span class=\"token comment\">// more ...</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentdidUpdate</span><span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n   <span class=\"token comment\">// extra logic here</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// clear all the side effects</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>timerId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    document<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'...'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">cancelRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>UI</span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>Code is spread across different life cycle hooks</li>\n<li>No single responsibility</li>\n<li>Hard to test</li>\n</ul>\n<h3>3. Classess are Hard for Humans and Machines</h3>\n<p>Looking at the human side of the problem, we all once tripped trying to call a function inside a child component and it says:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">TypeError<span class=\"token punctuation\">:</span> Cannot read property <span class=\"token string\">'setState'</span> <span class=\"token keyword\">of</span> undefined</code></pre></div>\n<p>and then scratched our head trying to figure out the cause: that you have forgotten to bind it in the constructor. So, <em>this</em> remains the topic of confusion even among some experienced developers. I have written a separate article to discuss more about this. If you interested, give it a read.</p>\n<blockquote>\n<p><strong>this</strong> gets the value of object who invokes the function</p>\n</blockquote>\n<p>Also, you need to write lots of boilerplate code to even start implementing the first side effect:</p>\n<p><code class=\"language-text\">extends -&gt; state -&gt; componentDidMount -&gt; componentWillUnmount -&gt; render -&gt; return</code></p>\n<p>Classes are also hard for machines for the following reasons:</p>\n<ul>\n<li>Minified version won‚Äôt minify method names</li>\n<li>Unused methods won‚Äôt get stripped out</li>\n<li>Difficult with hot reloading and compiler optimisation</li>\n</ul>\n<hr>\n<p>All the three problems we discussed above are not three distinct problems but these are symptoms of one single problem and that is React has <code class=\"language-text\">no stateful primitive</code> simpler than class component.</p>\n<hr>\n<p>With the advent of the new React Hooks proposal API, we can solve this problem by abstracting our logic completely outside of our component. In fewer words, you can hook a stateful logic into the functional component.</p>\n<blockquote>\n<p>React Hooks allow you to use state and other\nReact features without writing a class.</p>\n</blockquote>\n<p>Let‚Äôs see that in the code example below:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">MouseTracker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// useState accepts initial state and you can use multiple useState call</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>mouseX<span class=\"token punctuation\">,</span> setMouseX<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>mouseY<span class=\"token punctuation\">,</span> setMouseY<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      mouseX: </span><span class=\"token punctuation\">{</span>mouseX<span class=\"token punctuation\">}</span><span class=\"token plain-text\">, mouseY: </span><span class=\"token punctuation\">{</span>mouseY<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p>A call to <a href=\"https://reactjs.org/docs/hooks-state.html\">useState</a> hook returns a pair of values: the current state and a function that updates it. In our case, the current state value is <em>mouseX</em> and setter function is <em>setMouseX</em>. If you pass an argument to useState, that becomes the initial state of your component.</p>\n<p>Now, the question is where do we call setMouseX. Calling it below the useState hook will cause an error. It will be the same as calling <em>this.setState</em> inside <em>render</em> function of class components.</p>\n<p>So, the answer is that React also provides a placeholder hook called <a href=\"https://reactjs.org/docs/hooks-effect.html\">useEffect</a> for performing all side effects.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">MouseTracker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// useState accepts initial state and you can use multiple useState call</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>mouseX<span class=\"token punctuation\">,</span> setMouseX<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>mouseY<span class=\"token punctuation\">,</span> setMouseY<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">function</span> <span class=\"token function\">handler</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> clientX<span class=\"token punctuation\">,</span> clientY <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">setMouseX</span><span class=\"token punctuation\">(</span>clientX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token function\">setMouseY</span><span class=\"token punctuation\">(</span>clientY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// side effect</span></span><span class=\"gatsby-highlight-code-line\">    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mousemove'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// Every effect may return a function that cleans up after it</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mousemove'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      mouseX: </span><span class=\"token punctuation\">{</span>mouseX<span class=\"token punctuation\">}</span><span class=\"token plain-text\">, mouseY: </span><span class=\"token punctuation\">{</span>mouseY<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This effect will be called both after the first render and after every update. You can also return an optional function which becomes a <em>cleanup</em> mechanism. This lets us keep the logic for adding and removing subscriptions close to each other.</p>\n<p>The second argument to useEffect call is an optional array . Your effect will only re-run when the element value inside the array changes. Think of this as how <a href=\"https://reactjs.org/docs/react-component.html#shouldcomponentupdate\">shouldComponentUpdate</a> works. If you want to run an effect and clean it up only once (on mount and unmount), you can pass an <strong>empty array</strong> ([]) as a second argument. This tells React that your effect doesn‚Äôt depend on any values from props or state, so it never needs to re-run. This is close to the familiar mental model of <em>componentDidMount</em> and <em>componentWillUnmount</em>.</p>\n<p>But isn‚Äôt our <em>MouseTracker</em> component still holding the logic inside? What if another component wants to share mousemove behaviour as well? Also, adding one more effect (e.g window resize) would make it little hard to manage and we are back to the same problem as we saw in class components.</p>\n<p>Now, the real magic is you can create your custom hooks outside of your function component. It is similar to keeping the logic <code class=\"language-text\">abstracted</code> to a <code class=\"language-text\">separate module</code> and share it across different components. Let see that in action.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// you can write your custom hooks in this file</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">useMouseLocation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>mouseX<span class=\"token punctuation\">,</span> setMouseX<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>mouseY<span class=\"token punctuation\">,</span> setMouseY<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">handler</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> clientX<span class=\"token punctuation\">,</span> clientY <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setMouseX</span><span class=\"token punctuation\">(</span>clientX<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setMouseY</span><span class=\"token punctuation\">(</span>clientY<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mousemove'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mousemove'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>mouseX<span class=\"token punctuation\">,</span> mouseY<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p>And now we can clean up our MouseTracker component code (90%) to a newer version as shown below:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useMouseLocation <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'customHooks.js'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">MouseTracker</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// using our custom hook</span>\n<span class=\"gatsby-highlight-code-line\"> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>mouseX<span class=\"token punctuation\">,</span> mouseY<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useMouseLocation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">      mouseX: </span><span class=\"token punctuation\">{</span>mouseX<span class=\"token punctuation\">}</span><span class=\"token plain-text\">, mouseY: </span><span class=\"token punctuation\">{</span>mouseY<span class=\"token punctuation\">}</span><span class=\"token plain-text\"></span>\n<span class=\"token plain-text\">    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p>That‚Äôs kind of a ‚ÄúEureka‚Äù moment! Isn‚Äôt it?</p>\n<p>But before settling down and singing praises of React Hooks, let‚Äôs see what rules we should be aware of.</p>\n<h3>Rules of Hooks</h3>\n<ul>\n<li>Only call hooks at the top level</li>\n<li>Can‚Äôt use hooks inside class component</li>\n</ul>\n<p>Explaining these rules are beyond the scope of this article. If you‚Äôre curious, I would recommend reading React <a href=\"https://reactjs.org/docs/hooks-rules.html\">docs</a> and this <a href=\"https://medium.com/@ryardley/react-hooks-not-magic-just-arrays-cd4f1857236e\">article</a> by Rudi Yardley.</p>\n<p>React also has released an ESLint plugin called eslint-plugin-react-hooks that enforces these two rules. You can add this to your project by running:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">npm install eslint<span class=\"token operator\">-</span>plugin<span class=\"token operator\">-</span>react<span class=\"token operator\">-</span>hooks@next</code></pre></div>\n<p>This article was part of my <a href=\"https://twitter.com/reactsydney/status/1069498781324914689?s=19\">talk</a> at the ReactSydney meetup December, 2018. I hope this article has intrigued you to give React hooks a try. React 16.8.0 is the first release to support Hooks. I am super excited about the React <a href=\"https://reactjs.org/blog/2018/11/27/react-16-roadmap.html\">roadmap</a> which looks very promising and has the potential to change the way we use React currently.</p>\n<p>You can find the source code and demo at this <a href=\"https://codesandbox.io/s/6ymrnqn43w\">link</a>.</p>\n<p>Hope you‚Äôve enjoyed reading this article. There‚Äôs more to come üòÉ.</p>","frontmatter":{"title":"How to write 90% cleaner code with Hooks üé£","date":"December 07, 2018","description":"Hook are the new programming model in React. Are you up and ready to embrace it?"}}},"pageContext":{"slug":"/how-to-write-cleaner-code-with-hooks/","previous":{"fields":{"slug":"/purecomponent-caveats/"},"frontmatter":{"title":"PureComponent Caveats"}},"next":{"fields":{"slug":"/why-do-we-need-to-bind-methods-inside-out-component's-constructor/"},"frontmatter":{"title":"Why do we need to bind methods inside our component‚Äôs constructor?"}}}}